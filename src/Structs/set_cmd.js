/* eslint-disable no-unused-expressions */
const { Struct } = require('struct');
const net = require('net');
const { Console } = require('console');
const { formatServerData } = require('./daq_t');
const { createCmdStruct } = require('./cmd_t');

// 88888888 04CC0120 2000 000000000000 3442 000034420000344200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099999999
// 88888888 04cc0120 2000 000000000000 00420000c4420000204100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099999999
// AAAAAAAA0000000000000000000000000000000000000000000000000000010101010000BBBBBBBB
// aaaaaaaa0000f042002081450000f0420080ac4300000000000000000000010101010000bbbbbbbb

const cmdStruct = createCmdStruct();
let dataToSend = 1;

function updateStructCommands(data) {
  const {
    MdlManChr, MdlManInj, MdlManCdr, MdlManCar, MdlExhAcv, MdlMisAcv, MdlIgnAcv, MdlAlmAcv,
  } = data;
  console.log(MdlManCar);
  cmdStruct.fields.CmdMemVal[0].MdlManChr = 100;
  cmdStruct.fields.CmdMemVal[0].MdlManInj = 100;
  cmdStruct.fields.CmdMemVal[0].MdlManCdr = 100;
  cmdStruct.fields.CmdMemVal[0].MdlManCar = 100;
  cmdStruct.fields.CmdMemVal[0].MdlExhAcv = dataToSend;
  cmdStruct.fields.CmdMemVal[0].MdlMisAcv = dataToSend;
  cmdStruct.fields.CmdMemVal[0].MdlIgnAcv = dataToSend;
  cmdStruct.fields.CmdMemVal[0].MdlAlmAcv = dataToSend;
  console.log(cmdStruct.buffer().toString('hex'));
  dataToSend = dataToSend ? 0 : 1;
}

function sendData() {
  const buf = cmdStruct.buffer();
  return buf;
}

module.exports = { updateStructCommands, sendData };
